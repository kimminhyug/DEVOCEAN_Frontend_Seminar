# DEVOCEAN_Frontend_Seminar
DEVOCEAN_ 6월 Tech 세미나 - 웹 프론트엔드 성능 최적화 방법 및 적용 사례_후기

* 날짜: 2023-06-22
* 시간: 19:00 ~ 21:00

개요
-----
* 프론트엔드 성능 최적화에 방법에 관심이 있습니다.
* 대용량 데이터를 불러오는동안 어떤 방법으로, 어떤 레이아웃의  화면을 보여주는지 트렌드를 보고 싶어 세미나에 참여 하였습니다.

* 현재 SPA 방식으로 회사 업무를 진행 하고 있으며, 주로 대시보드를 개발 하고 있습니다.
* 실시간으로 대용량 데이터를 보여줘야 하는 상황인데 성능 개선을 어떻게 더 할 수 있을지, 사용자에게 어떻게 해야 더 좋은 경험을 줄 수 있을지, 고민 중입니다.
 
내용
-----------------------




1. 최적화를 해야 하는 이유
* 아래는 로딩 시간에 따른 사용자 이탈치입니다.
```js
1초 ~ 3초 32%
1초 ~ 5초 90%
1초 ~ 6초 106%
1초 ~ 10초 123%
 ```
 
* 당연한 이야기겠지만 로딩 시간이 길수록 사용자는 다른 사이트로 이동 할 가능성이 높으며, 구글링을 즐겨하는 저도 3초 이상 컨텐츠가 보이지 않으면, 창을 닫습니다.
* 보통 로딩 시간은 대용량 멀티미디어 파일, 오랜 시간이 소요되는 api들을 말하는 것이며, 해당 웹 브라우저에서는 시간을 최소화 하는게 가장 중요합니다.
  
2. 최적화 측정
   * Core Web Vitals(Google에서 제시한 최적화 지표며 사용자 입장에서 바라본 지표) 
     * LCP: 화면 로딩시 가장 큰 영역을 가진 컨텐츠가 얼마나 빨리 뜨는지(보통 이미지)
      * ex) 술집에서 술 안주가 얼마나 빨리 나오는지(기본 안주가 나오는 속도 X, 메인이 가장 빨리 나와야 함)
     * FID: 페이지에서 사용자 터치등 이벤트가 일어났을떄 얼마나 빨리 반응 하는지
      * ex) 부장님이 나를 부를떄 내가 "네" 라고 대답 하는 속도: FID
     * CLS: 사용자가 컨텐츠를 얼마나 안정적이게 볼 수 있는지
      * ex) 요즘 콘서트 벽 뷰라는것이 존재하는데, 아무런 사용자가 아무런 작업을 하지 않았음에도 컨텐츠가 보이지 않는경우 CLS가 낮다고 판단
     * INP: FID 대체 예정이며, 제일 오래 걸린 시간과 제일 빠른 시간을 뺸 나머지 데이터의 평균이며, 전체적인 컨텐츠의 속도를 측정하기 위해 대채하는것으로 추정됩니다.(이건 제 의견으로 추후 찾아봐야합니다)

   * 세미나를 듣기전 회사 업무에서 Lighthouse를 이용하여 여유 시간이 있을때 마다 측정하여 개선을 진행하고 있었습니다.
     * Chrome UX Report : 무려 대시보드 제공 한다니, 테스트 필요
     
   * RUM 데이터를 테스트 하기 위한 tools
   * 성능 테스트를 할때 보통 개발자는 캐시가 존재하여 사용자와 성능이 다르게 제공 될 수 있기에, 사용자와 최대한 동일한 환경에서 테스트를 하기위해 아래 Tool을 이용 합니다.
     * 회사에서  써보고싶은데 유료인지 무료인지 확인 먼저 필요
      > 구글에서 제공하는 툴은 파이어폭스등 일부 브라우저를 지원하지 않을 수도 있음
     * Search Cosnole
     * PageSpeed Insights
     * web-vitials-js(무려 자바스크립트 라이브러리)
     * Chrome user Experience Report

  


3. 최적화 방법

* 사실 비싸지만 제일 빠른 개선 방법
  *  CDN(가까운 지역에서 다운 받게)
 
* CLS
  * 컨텐츠의 사이즈를 명확하게 지정 하는 방법
  * 보통 동적으로 영역의 높이를 계산할때 컨텐츠가 계산 하기전 보다 밀려 보이는것
   * 회사 일부 코드에서도 setTimeout을 이용하여 높이를 계산하는 로직이 있어, 굉장이 보기 안 좋음
 * 따라서 해당 경험을 더 좋게 하기 위해서는 미리 영역을 할당 받아 놓음.
   * 최소화 하기 위해 min-height를 활용
   * 브라우저 , 모바일과의 반응성 개선에서는 "aspect-ratio" 라는 것을 활용
   * 해당 프로퍼티는 Google I/O 에서 설명을 듣고 업무에 적용한 경험이 있음.

* 항상 알고 있던 것이지만 자바 스크립트는 싱글 스레드
  * 따라서 작업을 최대한 분활 시켜야 성능 개선에 도움이 됨
  * 예전에 드론기술개발 사업을 진행할 떄 시물레이샨 개발을 하면서 requestFrame으로 인해 속도가 느려젔던 경험을 기억 하면 될 꺼같음
  * 모든것을 렌더링 하지말고, 필요한 부분만 렌더링(보통 리액트에서 생명주기를 얼마나 잘 관리 하는지가 관점 일듯, pureComponent, memo 등)
   
* 최근에 발견하여 정말 고민인 것. DOM SIZE가 너무 큰 경우
  * 중첩된 DOM SIZE가 클수록 성능이 굉장히 떨어지는데 어떻게 DOM을 최소화 할지 고민이 필요 합니다.
  * 저는 개인적으로 Atomic design 방식을 좋아하여, 개인 라이브러리 또는 회사 업무에서 해당 디자인 방식을 사용하는데, 어떻게 해야 더 깔끔하게 설계를 할 수있을지 고민 입니다.

* 당연한 이야기지만 각 컴포넌트에서 불필요한 코드, 또는 라이브러리를 제거해야 초기 페이지가 더 빠르게 그려집니다.

* 이미지 렌더링 관련 내용
  *  <source media> 태그를 이용하여, 플랫폼별로 알맞는 이미지를 불러오도록 설정 할 수 있음(이미지를 불러오는것이 가장 큰 시간을 차지하므로 가장 중요하다고 생각됨)
  * 페이지 로딩시 불필요한 이미지를 한번에 로드하여, 자원낭비를 발생 시킴
    * loading="lazy" 라는것이 존재함 (굳이 한번에 요청하지 않고, 사용자가 해당 컨텐츠에 접근하게되면 로딩을 시작 하는것으로)
  * WebP, AVIF 가 PNG, JPEG에 비해 압축률이 우수하여 성능이 더 빠름
    * 단 브라우저마다 지원 여부가 다름.
  * 잘못된 해상도의 이미지를 사용 하는 경우 (BAD)
    * 회사 로고정도의 사이즈(120 * 150)로 사용할 것이면서, 4k 해상도의 이미지를 불러와서 적용하는 경우
  * fetchpriority="high"
    * fetchpriority="high" 이용하여 <img> 등 컨텐츠에 우선 순위를 지정 할 수 있음
    * 메인 화면에 뜨는 이미지의 우선순위를 높게 잡아 최대한 먼저 불러 올 수 있도록
  * rel="prelaod"
    * 외부 리소스를 불러오는 경우 html header에 <link rel="prelaod" 를 이용하여 최대한 lcp를 빠르게 설정 할 수 있음
  * html inline - svg로 추가하는경우 더 자연스럽게 화면을 그릴수 있음
    * 현재 회사에서 헤더의 로고가 다른 컴포넌트 느리게 그려지고 있으며, 해당 방식으로 개선 할 수 있을것으로 보입니다.


4. 후기
 회사에서 다른 팀원들과 달리 담당 기능에서 lighthouse를 이용하여 성능 지표를 측정하고 성능개선을 하고 있었는데, 사실 혼자 너무 유난 떠는건가 걱정 했었습니다.
 하지만 세미나를 감상하면서, 실제로 회사 담당 기능에서해당 지표를 이용하여 개선하려던것이 정답이었으며, 더 좋은 품질로 개선 하고 있었다는것을 알게 되니 안도가 되었습니다.

 위에서도 작성 하였지만, 성능 개선 적용 사례에서 저에게 필요한 몇몇 사례도 발견을 하였기에 많은 도움이 되었고, 추후 개발을 할때 해당 항목들을 점검하여, 문제 되는 부분을 해결 할 계획 입니다.

 

5. 참고
* 강사분들이 강력 추천하는 지표 측정 tool
 * https://www.webpagetest.org/
* 체크리스트로 점검 해 볼만한 내용
 * ![image](https://github.com/kimminhyug/DEVOCEAN_Frontend_Seminar/assets/42853144/a5efb64f-04c6-4382-ab16-44304f18a0c7)
